\documentclass{article}
\usepackage[utf8]{inputenc}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{amssymb}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}
\newtheorem{comment}{Comment}


\title{Integral Power Series}
\author{Drew Duncan}
\date{\today}

\begin{document}

\maketitle

\section{Notes}
There is a mistake in Proposition 3.4 of \cite{integerpowerseries_MR2416254}.  It is the case that $x + \ldots$ is irreducible as a power series although the constant coefficient is not a prime power (unless you consider 0 to be a prime...).  The quotients by these irreducibles are simply $\mathbb{Z}$.


Can Hensel's Lemma be extended to cases where it is necessary to look modulo a higher power of $p$ to find coprime factors?

\section{Isomorphisms}
\begin{theorem} \label{iso1}
Let $f$ be a power series over $\mathbb{Z}$ with constant coefficient a prime power $q = p^n$.  Then $\mathbb{Z}[[x]]/f\mathbb{Z}[[x]] \cong \mathbb{Z}_p[[x]]/f\mathbb{Z}_p[[x]]$.
\end{theorem}
\begin{proof}
Given some coset $a + f\mathbb{Z}_p[[x]]$ with $a(x) = a_0 + a_1x + a_2x^2 + \ldots \in \mathbb{Z}_p[[x]]$, write $a_0$ as $a_0 = \alpha_0 + \alpha_1q + \alpha_2q^2 + \ldots$ with $\alpha_i \in \{0,1,\ldots,q-1\}$.  Then $a_0 = \alpha_0 + q(\alpha_1 + \alpha_2q + \ldots) = \alpha_0 + (q-f)(\alpha_1 + \alpha_2q + \ldots) + f(\alpha_1 + \alpha_2q + \ldots)$.  $q-f$ is some multiple of $x$, and so collecting terms we have $a(x) = \alpha_0 + b_1x + b_2x^2 + \ldots + \beta f$, $\beta \in \mathbb{Z}_p[[x]]$.  Continuing in this way, we obtain a representative $\gamma(x) = \gamma_0 + \gamma_1x + \gamma_2x^2 + \ldots$ of the coset $a + f\mathbb{Z}_p[[x]] = \gamma + f\mathbb{Z}_p[[x]]$ with $\gamma_i \in \{0,1,\ldots,q-1\}$.  Any other representative of this coset differs from $\gamma$ by a multiple of $f$, and so differs in some coefficient by a multiple of $q$.  Thus, $\gamma$ is the unique representative satisfying this property.

\textit{A fortiori}, we can perform this same rewriting on an element $b(x) \in \mathbb{Z}[[x]]$ to obtain a unique canonical representative with coefficients from $0$ to $q-1$.  Because in both cases we get the same set of canonical representatives, this yields a bijection between $\mathbb{Z}[[x]]/f\mathbb{Z}[[x]]$ and $\mathbb{Z}_p[[x]]/f\mathbb{Z}_p[[x]]$ which is evidently a homomorphism.
\end{proof}

\begin{comment}
This does not hold when the constant coefficient is merely a multiple of p.  The proof breaks down because the sets of canonical representatives in the two rings will not be the same.
\end{comment}


\begin{theorem} \label{iso2}
Let $f=f_ex^e - f_{e-1}x^{e-1} - \ldots - f_0$ be a polynomial over $\mathbb{Z}_p$ with $p | f_i$ for $i \ne e$ and $p \nmid f_e$.  Then $\mathbb{Z}_p[[x]]/f\mathbb{Z}_p[[x]] \cong \mathbb{Z}_p[x]/f\mathbb{Z}_p[x]$.
\end{theorem}
\begin{proof}
Without loss of generality, assume $f_e = 1$.  Let $f_i = pg_i$ for $i \ne e$ Given some coset $a + f\mathbb{Z}_p[[x]]$ with $a(x) = a_0^{(0)} + a_1^{(0)}x + a_2^{(0)}x^2 + \ldots \in \mathbb{Z}_p[[x]]$, write $a$ as $$a(x) = a_0^{(0)} + a_1^{(0)}x + \ldots + a_{e-1}^{(0)}x^{e-1} + x^e(a_e^{(0)} + a_{e+1}^{(0)}x + \ldots).$$  Then $$a(x) = a_0^{(0)} + a_1^{(0)}x + \ldots + a_{e-1}^{(0)}x^{e-1} + (x^e - f)(a_e^{0} + a_{e+1}^{0}x + \ldots) + f(a_e^{0} + a_{e+1}^{0}x + \ldots) = $$
$$a_0^{0} + a_1^{0}x + \ldots + a_{e-1}^{0}x^{e-1} + p(g_0 + g_1x + \ldots + g_{e-1}x^{e-1})(a_e + a_{e+1}x + \ldots) + \alpha f.$$  Collecting terms, we get $$a(x) = a_0^{(0)} + a_1^{(0)}x + \ldots + a_{e-1}^{(0)}x^{e-1} + p(b_0 + b_1x + \ldots) + \alpha f = $$
$$a_0^{(1)} + a_1^{(1)}x + \ldots + a_{e-1}^{(1)}x^{e-1} + px^e(b_e + b_{e+1}x + \dots) + \alpha f =$$
$$a_0^{(2)} + a_1^{(2)}x + \ldots + a_{e-1}^{(2)}x^{e-1} + p^2(c_0 + c_1x + \ldots) + \alpha'f.$$  Continuing in this way, we see that at each step $a_i^{(k)}$ differs from $a_i^{(k-1)}$ by a multiple of $p^k$, and $a(x) - a_0^{(k)} + a_1^{(k)}x + \ldots + a_{e-1}^{(k)}$ differs from some multiple of $f$ by a multiple of $p^k$.  Thus $a_i^{(j)} \to a_i$, and we obtain a representative $\hat{a}(x) = a_0 + a_1x + \ldots + a_{e-1}x^{e-1}$ of the coset $a + f\mathbb{Z}_p[[x]] = \hat{a} + f\mathbb{Z}_p[[x]]$.  Any other representative differs by a nonzero multiple of $f$, and so has larger degree than $\hat{a}$.  Thus $\hat{a}$ is the unique representative of degree less than $e$.


\textit{A fortiori}, this rewriting procedure works for finding a unique canonical representative of the coset $b + \mathbb{Z}_p[x]$, yielding the same set of canonical representatives and thus a bijection between $\mathbb{Z}_p[[x]]/f\mathbb{Z}_p[[x]]$ and $\mathbb{Z}_p[x]/f\mathbb{Z}_p[x]$ which is evidently a homomorphism.
\end{proof}

\begin{theorem}
A polynomial over $\mathbb{Z}$ with all coefficients except the leading coefficient divisible by $p$ is irreducible as a power series over $\mathbb{Z}$ if and only if it is irreducible as a polynomial over $\mathbb{Z}_p$.
\end{theorem}
\begin{proof}
This is an immediate consequence of the previous two isomorphisms.
\end{proof}

\begin{corollary}\label{zp}
For $n \ge 1$, $\mathbb{Z}[[x]]/(p^n-x) \cong \mathbb{Z}_p$.
\end{corollary}
\begin{proof}
This is also an immediate consequence of the previous two isomorphisms.
\end{proof}

A different but intimately related proof of the special case $n=1$ can also be found in \cite{MR1697859}, page 114.

The following statement and proof of Hensel's Lemma were influenced by corresponding presentation in  \cite{MR1697859}, page 129, adapted for use on power series.

\begin{theorem}[Hensel's Lemma]\label{hensel}  Let $\mathcal{O}$ be a local ring, $\pi$ be a generator of the unique maximal ideal, and $\kappa = \mathcal{O}/(\pi)$ be the residue field.
If a primitive power series $f(x) \in \mathcal{O}[[x]]$ admits modulo $\pi$ a factorization
$$f(x) \equiv \bar{g}(x)\bar{h}(x) \bmod{\pi}$$
into relatively prime power series $\bar{g},\bar{h} \in \kappa[[x]]$, then $f(x)$ admits a factorization
$$f(x) = g(x)h(x)$$
into power series $g,h \in \mathcal{O}[[x]]$ such that $$g(x) \equiv \bar{g}(x) \bmod{\pi}\mbox{, } h(x) \equiv \bar{h}(x) \bmod{\pi},$$
and $\deg(g) = \deg(\bar{g})$ (using the convention that a power series which is not a polynomial has infinite degree).
\end{theorem}
\begin{proof}
%Let $d = \deg(f)$, $m = \deg(\bar{g})$, hence $d - m \ge \deg(\bar{h})$ (with the convention that the degree of a power series which is not a polynomial is infinite).

Let $g_0, h_0 \in \mathcal{O}[[x]]$ be power series such that $g_0 \equiv \bar{g} \bmod \pi$, $h_0 \equiv \bar{h} \bmod \pi$ and $\deg(g_0) = \deg(\bar{g})$, $\deg(h_0) \le \deg(f) - \deg(\bar{g})$. Since $(
\bar{g}, \bar{h}) = 1$, there exist power series $a, b \in \mathcal{O}[[x]]$ satisfying $ag_0 + bh_0 \equiv 1 \bmod \pi$.  Among the coefficients of the two power series $f-g_0h_0 \mbox{, } ag_0 + bh_0 - 1 \in \pi\mathcal{O}[[x]]$, pick one with minimum value and call it $\rho$.

Suppose now that we have $$f \equiv (g_0 + g_1\rho + g_2\rho^2 + \ldots + g_{n-1}\rho^{n-1})(h_0 + h_1\rho + h_2\rho^2 + \ldots + h_{n-1}\rho^{n-1}) \bmod \rho^{n}$$ 
for some $n \ge 1$.
Let $f_n = \rho^{-n}(f - (g_0 + \ldots + g_{n-1}\rho^{n-1})(h_0 + \ldots + h_{n-1}\rho^{n-1}))$.  If $\deg(g_0) < \infty$, then it is a polynomial with a unit leading coefficient.  In this case, we may write $bf_n = qg_0 + g_n$, with $\deg(g_n) < \deg(g_0)$ and $q \in \mathcal{O}[[x]]$.  Otherwise, simply let $q = 1$, $g_n = bf_n$.  Omit all coefficient from $af_n + h_0q$ divisible by $\rho$ and let this be $h_n$, so that $\deg(h_n) \le \deg(f) - \deg(g_0)$.  Thus, $$g_0h_n + h_0g_n = g_0(af_n + h_0q) + h_0g_n = f_n(ag_0 + bh_0) \equiv f_n \bmod \rho,$$
and so,
$$(g_0 + \ldots + g_n\rho^n)(h_0 + \ldots + h_n\rho^n) \equiv f \bmod \rho^{n+1}.$$

Continuing in this way, $$\lim_{n \to \infty}(g_0 + \ldots + g_n\rho^n) = g \mbox{, } \lim_{n \to \infty}(h_0 + \ldots + h_n\rho^n) = h,$$ and $f = gh$.

%Let us look for power series $g$ and $h$ in the form:

%$$g = g_0 + p_1\pi + p_2\pi^2 + \ldots,$$
%$$h = h_0 + q_1\pi + q_2\pi^2 + \ldots,$$
%where $p_i, q_i \in \mathcal{O}[[x]]$ are power series of degree $< m$, resp. $\le d - m$.  We then determine successively the power series
%$$g_{n-1} = g_0 + p_1\pi + p_2\pi^2 + \ldots + p_{n-1}\pi^{n-1},$$
%$$h_{n-1} = h_0 + q_1\pi + q_2\pi^2 + \ldots + q_{n-1}\pi^{n-1},$$
%in such a way that one has
%$$f \equiv g_{n-1}h_{n-1} \bmod \pi^n.$$
%Passing to the limit as $n \to \infty$, we will finally obtain the identity $f = gh$.  For $n=1$ the congruence is satisfied in view of our choice of $\pi$.  Let us assume that it is already established for some $n \ge 1$.  Then, in view of the relation
%$$g_n = g_{n-1} + p_n\pi^n, \mbox{ } h_n = h_{n-1} + q_n\pi^n,$$
%the condition on $g_n$, $h_n$ reduces to
%$$f - %g_{n-1}h_{n-1} \equiv (g_{n-1}q_n + h_{n-1}p_n)\pi^n \bmod \pi^{n+1}.$$
%Dividing by $\pi^n$, this means
%$$g_{n-1}q_n + h_{n-1}p_n \equiv g_0q_n + h_0p_n \equiv f_n \bmod \pi,$$
%where $f_n = \pi^{-n}(f - g_{n-1}h_{n-1}) \in \mathcal{O}[[x]]$.  Since $g_0a + h_0b \equiv 1 \bmod \pi$, one has
%$$g_0af_n + h_0bf_n \equiv f_n \bmod \pi.$$
%At this point we would like to put $q_n = af_n$ and $p_n = bf_n$, but the degrees might be too big.  For this reason, we write
%$$b(x)f_n(x) = q(x)g_0(x) + p_n(x),$$
%where $\deg(p_n) < \deg(g_0) = m$.  Since $g_0 \equiv \bar{g} \bmod \mathfrak{p}$ and $\deg(g_0) = \deg(\bar{g})$, the highest coefficient of $g_0$ is a unit; hence $q(x) \in \mathcal{O}[[x]]$ and we obtain the congruence
%$$g_0(af_n + h_0q) + h_0p_n \equiv f_n \bmod \pi.$$
%Omitting now from the power series $af_n + h_0q$ all coefficients divisible by $\pi$, we get a power series $q_n$ such that $g_0q_n + h_0p_n \equiv f_n \bmod \pi$ and which, in view of $\deg(f_n) \le d$, $\deg(g_0) = m$ and $\deg(h_0p_n) < (d-m) + m = d$, has degree $\le d-m$ as required.
\end{proof}

The following comes from \cite{MR1697859}, page 116, exercise 9.

\begin{theorem}[$p$-adic Weierstrass Preparation Theorem] \label{preparation}
Every nonzero power series $a(x) = a_0 + a_1x + a_2x^2 + \ldots \in \mathbb{Z}_p[[x]]$ admits a unique representation $a(x) = p^\mu a'(x)u(x)$ where $p^\mu$ is the highest power of $p$ dividing $a$, $u(x)$ is a unit in $\mathbb{Z}_p[[x]]$, and $a'(x) \in \mathbb{Z}_p[x]$ is a monic polynomial of degree $e$, with every coefficient except the leading coefficient divisible by $p$ and $e$ being the least value such that $p^\mu \mid a_e$.
\end{theorem}
\begin{proof}
Let $b(x) = p^{-\mu}a(x)$.  $b \equiv x^e(\alpha + \ldots) \bmod p$, with $\alpha$ a unit in $\mathbb{Z}_p$. By Hensel's Lemma, $b = a'u$ with $a' \equiv x^e \bmod p$, $\deg(a') = e$, the leading term of $a'$ a unit, and $u \equiv \alpha + \ldots \bmod p$, i.e., $u$ is a unit in $\mathbb{Z}_p[[x]]$.  Without loss of generality, assume the leading coefficient of $a'$ is $1$.  Suppose $b = b'v$ with $b'$ and $v$ satisfying the conditions above.  Then $a' = b'(vu^{-1})$, and because $\deg(a') = \deg(b') = e$,
$\deg(vu^{-1}) = 1$.  Because the leading terms of $a'$ and $b'$ are both 1, $u = v$ and so $a' = b'$.
\end{proof}

\begin{theorem}
A primitive power series $a(x)$ over $\mathbb{Z}$ with constant coefficient a power of prime $p$ is irreducible as a power series if and only if the associated polynomial $a'(x)$ of Theorem \ref{preparation} is irreducible as a polynomial over $\mathbb{Z}_p$.
\end{theorem} \label{polynomial}
\begin{proof}
$\mathbb{Z}[[x]]/a\mathbb{Z}[[x]] \cong \mathbb{Z}_p[[x]]/a\mathbb{Z}_p[[x]] \cong \mathbb{Z}_p[[x]]/ a'\mathbb{Z}_p[[x]] \cong \mathbb{Z}_p[x]/a'\mathbb{Z}_p[x]$.
\end{proof}

\begin{corollary}
Let $a = a_0 + a_1x + \ldots$.  Suppose $a_0$ is a positive power of prime $p$ and $p \nmid a_1$.  Then $a$ is irreducible.
\end{corollary}
\begin{proof}
The associated polynomial $a'$ from Theorem \ref{preparation} is linear.  Irreducibility follows from Theorem \ref{polynomial}.  A completely different proof appears in \cite{integerpowerseries_MR2416254}.
\end{proof}

\section{Quotients of $\mathbb{Z}[[x]]$}

Next I'll expand on the discussion of the relationship between $\mathbb{Z}[[x]]$, the ring of formal power series with integer coefficients and $\mathbb{Z}_p$, the ring of p-adic integers hinted at in Corollary \ref{zp}.  I will show that certain quotients of $\mathbb{Z}[[x]]$ are isomorphic to certain extensions of $\mathbb{Z}_p$.

\begin{theorem} \label{factor}
Let $a(x) = a_0 + a_1x + a_2x^2 + \ldots \in \mathbb{Z}[[x]]$, with $a_0$ a positive power of the prime $p$ and $p \nmid a$.  Let $e$ be the least value such that $a_e$ is not divisible by $p$.  Then $a(x)$ factors as $a(x) = r(x)s(x)$, $r,s \in \mathbb{Z}_p[[x]]$, $deg(r) = e$, $r_0, \ldots, r_{e-1}$ divisible by $p$, and $r_e$ and $s_0$ units in $\mathbb{Z}_p$.
\end{theorem}

\begin{proof}
$f(x) \equiv x^e g(x) \pmod{p}$, and by hypothesis $g(x)$ is not divisible by $x$ modulo $p$.  Thus by Hensel's Lemma we get a factorization $f(x) = r(x)s(x)$ with $deg(r) = e$.  Because $r(x) \equiv x^e \pmod{p}$, we must have that $r_0, \ldots, r_{e-1}$ are divisible by $p$ and $r_e$ not divisible by $p$.  Further, because $f_0 = r_0 s_0 = p$, $p^2$ does not divide $r_0$ and $s_0$ is a unit.
\end{proof}


\begin{theorem}
Let $f(x) \in \mathbb{Z}[x]$ be $f(x) = p + x^e g(x)$ with $g_0$ not divisible by p.  Then $\mathbb{Z}[[x]]/(f)$ is a totally ramified extension of $\mathbb{Z}_p$ of degree $e$.
\end{theorem}

\begin{proof}
By Theorem \ref{factor}, $f(x) = r(x)s(x)$ with $deg(r) = e$ and $s_0$ a unit in $\mathbb{Z}_p$.  Thus $s(x)$ is a unit in $\mathbb{Z}_p[[x]]$.  Therefore, by Theorems \ref{iso1} and \ref{iso2}, $\mathbb{Z}[[x]]/f\mathbb{Z}[[x]] \cong \mathbb{Z}_p[[x]]/f\mathbb{Z}_p[[x]] \cong \mathbb{Z}_p[[x]]/r\mathbb{Z}_p[[x]] \cong \mathbb{Z}_p[x]/r\mathbb{Z}_p[x]$.

Let $v_p$ be the $p$-adic valuation.  If $\alpha$ is a root of $r(x)$, then because $p \mid r_0, \ldots, r_{e-1}$, $v_p(\alpha^e) \ge 1$, and so $v_p(r_i \alpha^i) > 1$ for $0 < i < e$. Because $p^2 \nmid r_0$, $v_p(r_0) = 1 = v_p(\alpha^e)$, and so $v_p(\alpha) = 1/e$.

\end{proof}

\bibliographystyle{unsrt}
\bibliography{biblio}
\end{document}
